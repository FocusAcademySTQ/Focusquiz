<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="utf-8">
<title>Mapa d'Ã€sia Â· Joc de paÃ¯sos</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
  html,body{margin:0;height:100%;font-family:system-ui;background:#f8fafc}
  #map{height:100%;width:100%}
  #hud{
    position:fixed;top:clamp(16px,3vh,28px);left:50%;transform:translateX(-50%);
    background:white;padding:10px 16px;border-radius:12px;
    display:flex;gap:16px;align-items:center;
    box-shadow:0 4px 20px rgba(0,0,0,.15);z-index:1000
  }
  .pill{padding:4px 10px;border-radius:999px;font-weight:600}
  .ok{background:#dcfce7}.ko{background:#fee2e2}
  button{border:0;border-radius:8px;background:#e2e8f0;padding:8px 10px;cursor:pointer}
</style>
</head>
<body>
<div id="hud">
  <div><b>Troba:</b> <span id="ask">â€”</span></div>
  <div class="pill ok">âœ… <span id="good">0</span></div>
  <div class="pill ko">âŒ <span id="bad">0</span></div>
  <button id="again">ğŸ”„ Torna a comenÃ§ar</button>
</div>
<div id="map"></div>

<script>
// Mapa base sense noms
const map=L.map('map',{preferCanvas:true}).setView([35,90],3);
L.tileLayer('https://cartodb-basemaps-a.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}.png',{
  maxZoom:8, attribution:'Â© OpenStreetMap Â· Â© CartoDB'
}).addTo(map);

// Estils de paÃ¯sos
const base={color:'#1e293b',weight:1.2,fillColor:'#bfdbfe',fillOpacity:0.55};
const hover={weight:2,fillOpacity:0.75};
const ok={fillColor:'#22c55e',fillOpacity:0.8};
const ko={fillColor:'#ef4444',fillOpacity:0.8};

let capa,features=[],objectiu=null,okCount=0,koCount=0;

// Traduccions principals (anglÃ¨s â†’ catalÃ )
const trad={
  "China":"Xina","India":"Ãndia","Japan":"JapÃ³","South Korea":"Corea del Sud","North Korea":"Corea del Nord",
  "Mongolia":"MongÃ²lia","Russia":"RÃºssia","Kazakhstan":"Kazakhstan","Uzbekistan":"Uzbekistan","Turkmenistan":"Turkmenistan",
  "Kyrgyzstan":"Kirguizistan","Tajikistan":"Tadjikistan","Afghanistan":"Afganistan","Pakistan":"Pakistan",
  "Bangladesh":"Bangla Desh","Nepal":"Nepal","Bhutan":"Bhutan","Myanmar":"Myanmar","Thailand":"TailÃ ndia","Laos":"Laos",
  "Cambodia":"Cambodja","Vietnam":"Vietnam","Malaysia":"MalÃ isia","Singapore":"Singapur","Indonesia":"IndonÃ¨sia",
  "Philippines":"Filipines","Brunei":"Brunei","Sri Lanka":"Sri Lanka","Maldives":"Maldives",
  "Iran":"Iran","Iraq":"Iraq","Saudi Arabia":"ArÃ bia Saudita","Yemen":"Iemen","Oman":"Oman","United Arab Emirates":"Emirats Ã€rabs Units",
  "Qatar":"Qatar","Bahrain":"Bahrain","Kuwait":"Kuwait","Turkey":"Turquia","Georgia":"GeÃ²rgia","Armenia":"ArmÃ¨nia",
  "Azerbaijan":"Azerbaidjan","Israel":"Israel","Jordan":"JordÃ nia","Lebanon":"LÃ­ban","Syria":"SÃ­ria"
};

function toCA(n){return trad[n]||n;}
function actualitzarMarcador(){
  document.getElementById('good').textContent=okCount;
  document.getElementById('bad').textContent=koCount;
}
function nouObjectiu(){
  if(features.length===0)return;
  objectiu=features[Math.floor(Math.random()*features.length)];
  document.getElementById('ask').textContent=toCA(objectiu.properties.name);
}

// Carrega GeoJSON mundial i filtra Ã€sia
fetch('https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json')
.then(r=>r.json())
.then(world=>{
  // Filtre per coordenades aproximades del continent asiÃ tic
  world.features=world.features.filter(f=>{
    const b=L.geoJSON(f).getBounds();
    const c=b.getCenter();
    return c.lat>-10 && c.lat<80 && c.lng>25 && c.lng<180;
  });
  features=world.features;

  capa=L.geoJSON(world,{
    style:base,
    onEachFeature:(f,l)=>{
      l.on('mouseover',()=>l.setStyle(hover));
      l.on('mouseout',()=>capa.resetStyle(l));
      l.on('click',()=>{
        if(!objectiu)return;
        if(f.properties.name===objectiu.properties.name){
          l.setStyle(ok); okCount++;
        }else{
          l.setStyle(ko); koCount++;
        }
        actualitzarMarcador();
        nouObjectiu();
      });
    }
  }).addTo(map);

  map.fitBounds(capa.getBounds());
  nouObjectiu(); // Mostra el primer paÃ­s
})
.catch(e=>alert("Error en carregar el mapa: "+e));

document.getElementById('again').onclick=()=>{
  okCount=koCount=0;
  actualitzarMarcador();
  capa.eachLayer(l=>capa.resetStyle(l));
  nouObjectiu();
};
</script>
</body>
</html>
