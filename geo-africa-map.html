<!DOCTYPE html>
<html lang="ca">
<head>
<meta charset="utf-8">
<title>Mapa d'√Äfrica ¬∑ Joc de pa√Øsos</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
  html,body{margin:0;height:100%;font-family:system-ui;background:#f8fafc}
  #map{height:100%;width:100%}
  #hud{
    position:fixed;top:clamp(16px,3vh,28px);left:50%;transform:translateX(-50%);
    background:white;padding:10px 16px;border-radius:12px;
    display:flex;gap:16px;align-items:center;
    box-shadow:0 4px 20px rgba(0,0,0,.15);z-index:1000
  }
  .pill{padding:4px 10px;border-radius:999px;font-weight:600}
  .ok{background:#dcfce7}.ko{background:#fee2e2}
  button{border:0;border-radius:8px;background:#e2e8f0;padding:8px 10px;cursor:pointer}
</style>
</head>
<body>
<div id="hud">
  <div><b>Troba:</b> <span id="ask">‚Äî</span></div>
  <div class="pill ok">‚úÖ <span id="good">0</span></div>
  <div class="pill ko">‚ùå <span id="bad">0</span></div>
  <button id="again">üîÑ Torna a comen√ßar</button>
</div>
<div id="map"></div>

<script>
// Configura mapa base sense etiquetes
const map=L.map('map',{preferCanvas:true}).setView([0,20],3);
L.tileLayer('https://cartodb-basemaps-a.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}.png',{
  maxZoom:8, attribution:'¬© OpenStreetMap ¬∑ ¬© CartoDB'
}).addTo(map);

// Estils
const base={color:'#1e293b',weight:1.2,fillColor:'#bfdbfe',fillOpacity:0.55};
const hover={weight:2,fillOpacity:0.75};
const ok={fillColor:'#22c55e',fillOpacity:0.8};
const ko={fillColor:'#ef4444',fillOpacity:0.8};

let capa,features=[],objectiu=null,okCount=0,koCount=0;

// Traduccions principals (angl√®s ‚Üí catal√†)
const trad={
  "Morocco":"Marroc","Algeria":"Alg√®ria","Tunisia":"Tun√≠sia","Libya":"L√≠bia","Egypt":"Egipte",
  "Mauritania":"Maurit√†nia","Mali":"Mali","Niger":"N√≠ger","Chad":"Txad","Sudan":"Sudan","South Sudan":"Sudan del Sud",
  "Eritrea":"Eritrea","Djibouti":"Djibouti","Somalia":"Som√†lia","Ethiopia":"Eti√≤pia",
  "Senegal":"Senegal","Gambia":"G√†mbia","Guinea-Bissau":"Guinea Bissau","Guinea":"Guinea",
  "Sierra Leone":"Sierra Leone","Liberia":"Lib√®ria","Ivory Coast":"Costa d'Ivori","Ghana":"Ghana",
  "Togo":"Togo","Benin":"Ben√≠n","Nigeria":"Nig√®ria","Cameroon":"Camerun","Central African Republic":"Rep√∫blica Centreafricana",
  "Equatorial Guinea":"Guinea Equatorial","Gabon":"Gabon","Congo":"Congo","Democratic Republic of the Congo":"Rep√∫blica Democr√†tica del Congo",
  "Angola":"Angola","Zambia":"Z√†mbia","Malawi":"Malawi","Mozambique":"Mo√ßambic","Namibia":"Nam√≠bia",
  "Botswana":"Botswana","Zimbabwe":"Zimbabwe","South Africa":"Sud-√†frica","Lesotho":"Lesotho","Eswatini":"Eswatini",
  "Madagascar":"Madagascar","Seychelles":"Seychelles","Comoros":"Comores","Mauritius":"Maurici","Cape Verde":"Cap Verd"
};

function toCA(n){return trad[n]||n;}
function actualitzarMarcador(){
  document.getElementById('good').textContent=okCount;
  document.getElementById('bad').textContent=koCount;
}
function nouObjectiu(){
  if(features.length===0)return;
  objectiu=features[Math.floor(Math.random()*features.length)];
  document.getElementById('ask').textContent=toCA(objectiu.properties.name);
}

// Carrega GeoJSON mundial i filtra √Äfrica
fetch('https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json')
.then(r=>r.json())
.then(world=>{
  // Coordenades aproximades d‚Äô√Äfrica
  world.features=world.features.filter(f=>{
    const b=L.geoJSON(f).getBounds();
    const c=b.getCenter();
    return c.lat>-36 && c.lat<38 && c.lng>-25 && c.lng<60;
  });
  features=world.features;

  capa=L.geoJSON(world,{
    style:base,
    onEachFeature:(f,l)=>{
      l.on('mouseover',()=>l.setStyle(hover));
      l.on('mouseout',()=>capa.resetStyle(l));
      l.on('click',()=>{
        if(!objectiu)return;
        if(f.properties.name===objectiu.properties.name){
          l.setStyle(ok); okCount++;
        }else{
          l.setStyle(ko); koCount++;
        }
        actualitzarMarcador();
        nouObjectiu();
      });
    }
  }).addTo(map);

  map.fitBounds(capa.getBounds());
  nouObjectiu(); // Mostra el primer pa√≠s autom√†ticament
})
.catch(e=>alert("Error en carregar el mapa: "+e));

document.getElementById('again').onclick=()=>{
  okCount=koCount=0;
  actualitzarMarcador();
  capa.eachLayer(l=>capa.resetStyle(l));
  nouObjectiu();
};
</script>
</body>
</html>
